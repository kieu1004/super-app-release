(self.webpackChunkauth=self.webpackChunkauth||[]).push([["src_providers_AuthProvider_tsx"],{35578:function(e,t,n){var u=n(64836);Object.defineProperty(t,"__esModule",{value:!0}),t.useAuth=t.AuthContext=void 0;var r=u(n(84481)),a=r.default.createContext({signIn:function(e,t){},signOut:function(){},signUp:function(e,t){}});t.AuthContext=a;t.useAuth=function(){return r.default.useContext(a)}},58851:function(e,t,n){var u=n(64836);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=u(n(27424)),a=u(n(17156)),i=u(n(84481)),s=u(n(29450)),o=n(35578),d=n(33823),l=function(e){return e.RESTORE_TOKEN="RESTORE_TOKEN",e.SIGN_IN="SIGN_IN",e.SIGN_OUT="SIGN_OUT",e}(l||{}),f=function(e,t){switch(t.type){case l.RESTORE_TOKEN:return Object.assign({},e,{isSignout:t.payload,isLoading:!1});case l.SIGN_IN:return Object.assign({},e,{isSignout:!1,isUser:t.payload});case l.SIGN_OUT:return Object.assign({},e,{isSignout:!0,isUser:null});default:return e}};function c(e,t){return h.apply(this,arguments)}function h(){return(h=(0,a.default)((function*(e,t){try{var n=new FormData;n.append("buyerPhone",e),n.append("password",t);var u=yield fetch("http://149.28.134.133/api/v1/account/login-by-phone",{method:"POST",headers:{"Content-Type":"multipart/form-data"},body:n});if(200===u.status)return yield u.json();throw new Error("Failed to fetch user infor")}catch(e){throw e}}))).apply(this,arguments)}var y=function(e){var t=e.children,n=i.default.useReducer(f,{isLoading:!1,isSignout:!1,isUser:null}),u=(0,r.default)(n,2),h=u[0],y=u[1],p=i.default.useMemo((function(){return{signIn:(n=(0,a.default)((function*(e,t){try{var n=yield c(e,t);yield s.default.shared.setUserInfo(n),yield s.default.shared.setCredentials("dummy-auth-token"),y({type:l.SIGN_IN,payload:n})}catch(e){}})),function(e,t){return n.apply(this,arguments)}),signOut:(t=(0,a.default)((function*(){try{yield s.default.shared.removeUserInfo(),yield s.default.shared.removeCredentials()}catch(e){}y({type:l.SIGN_OUT})})),function(){return t.apply(this,arguments)}),signUp:(e=(0,a.default)((function*(e,t){try{var n=yield c(e,t);yield s.default.shared.setUserInfo(n),yield s.default.shared.setCredentials("dummy-auth-token"),y({type:l.SIGN_IN,payload:n})}catch(e){}})),function(t,n){return e.apply(this,arguments)})};var e,t,n}),[]);return i.default.useEffect((function(){var e,t=(e=(0,a.default)((function*(){var e,t;try{e=yield s.default.shared.getCredentials(),t=yield s.default.shared.getUserInfo()}catch(e){}y({type:l.RESTORE_TOKEN,payload:!e}),e&&t&&y({type:l.SIGN_IN,payload:t})})),function(){return e.apply(this,arguments)});t()}),[]),(0,d.jsx)(o.AuthContext.Provider,{value:p,children:t(h)})};t.default=y},29450:function(e,t,n){var u=n(64836);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,a=u(n(56690)),i=u(n(89728)),s=u(n(25656)),o=function(){function e(){(0,a.default)(this,e),this.TOKEN_KEY="token",this.USER_INFO="user_info"}return(0,i.default)(e,[{key:"getCredentials",value:function(){return s.default.getItem(this.TOKEN_KEY)}},{key:"setCredentials",value:function(e){return s.default.setItem(this.TOKEN_KEY,e)}},{key:"removeCredentials",value:function(){return s.default.removeItem(this.TOKEN_KEY)}},{key:"getUserInfo",value:function(){return s.default.getItem(this.USER_INFO).then((function(e){return e?JSON.parse(e):null}))}},{key:"setUserInfo",value:function(e){return s.default.setItem(this.USER_INFO,JSON.stringify(e))}},{key:"removeUserInfo",value:function(){return s.default.removeItem(this.USER_INFO)}}]),e}();r=o,o.shared=new r;var d=o;t.default=d}}]);//# sourceMappingURL=src_providers_AuthProvider_tsx.chunk.bundle.map?platform=ios